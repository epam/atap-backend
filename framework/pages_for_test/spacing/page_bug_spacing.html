<!DOCTYPE html>
<html><head>
  <title>Text Spacing FAIL</title>

<style>
  .red div { border: 6px red solid; }
  #test { transform: rotate(-5deg); }
  h2 { position: fixed; width: 100%; height: 20px; top: 120px; left: 40px;}
</style>
<style type="text/css">* { font-size: 30px; }</style></head>
<body>
  <div id="container" class="red">
    <div id="test">A test div</div>
  </div>

  <h2>Some other text <code>#anchor</code></h2>
  <button id="spacing" onclick="toggleSpacing(window);">on / off text spacing rules</button>
  <div id="sample"><style type="text/css" id="styleInDiv"></style></div>
  <div>
    <select name="choice" id="dropdown"><option value="">SELECTOR THING</option>
      <option value="">one</option>
      <option value="">then</option>
      <option value="">last</option>
    </select>
  &nbsp;
  <div>
    <p>Some more</p>
    <input type="text" placeholder="To be done?"></input>
    <br>
    <p>Surely, no</p>
    &nbsp;
  </div>
    <textarea name="areaOfText" cols="14" rows="10">
      But be careful with mE
    </textarea>
  </div>

  <script>
    const testDiv = document.querySelector('#test');
    const testHeader = document.querySelector('h2');
    document.querySelector('#spacing').addEventListener('click', () => {
      testDiv.style = 'transform: rotate(-5deg);';
      testHeader.style.color = "magenta";
    });
  </script>
  <script>
  var toggleSpacing = function () {
      /* bookmarklet from https://github.com/drewlee/1412bookmarklet */
      var name = 'WCAG 2.1 1.4.12 bookmarklet', style, sheet;
      var testDiv = document.querySelector('#test');
      var testHeader = document.querySelector('h2');
      var spacingRules = [
          '*{line-height:1.5em!important;}',
          '*{letter-spacing:0.12em!important;}',
          '*{word-spacing:0.16em!important;}',
          '*{margin-bottom:2em!important;}'];

      if (typeof window[name] !== 'undefined') {
          document.head.removeChild(window[name].instance);
          delete window[name];
          testHeader.style.color = "black";
      } else {
          style = document.createElement('style'),
          window[name] = {};
          window[name].instance = style;
          document.head.appendChild(style);
          spacingRules.forEach(rule => style.sheet.insertRule(rule));
          testHeader.style.color = "magenta";
      }
  };
  </script>


</body></html>
