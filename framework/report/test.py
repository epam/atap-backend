from docx import Document
from framework.report.parse_html import parse_html

doc = Document()
# text = """<p><strong>1.1.1 Non-text Content</strong> (Level A): All non-text content that is presented to the user has a text alternative that serves the equivalent purpose, except for the situations listed below:\n<ul><li>Controls, Input: If non-text content is a control or accepts user input, then it has a name that describes its purpose. (Refer to Success Criterion 4.1.2 for additional requirements for controls and content that accepts user input.)</li>\n<li>Time-Based Media: If non-text content is time-based media, then text alternatives at least provide descriptive identification of the non-text content. (Refer to Guideline 1.2 for additional requirements for media.)</li>\n<li>Test: If non-text content is a test or exercise that would be invalid if presented in text, then text alternatives at least provide descriptive identification of the non-text content.</li>\n<li>Sensory: If non-text content is primarily intended to create a specific sensory experience, then text alternatives at least provide descriptive identification of the non-text content.</li>\n<li>CAPTCHA: If the purpose of non-text content is to confirm that content is being accessed by a person rather than a computer, then text alternatives that identify and describe the purpose of the non-text content are provided, and alternative forms of CAPTCHA using output modes for different types of sensory perception are provided to accommodate different disabilities.</li>\n<li>Decoration, Formatting, Invisible: If non-text content is pure decoration, is used only for visual formatting, or is not presented to users, then it is implemented in a way that it can be ignored by assistive technology.</li></ul></p><p><strong>2.4.4 Link Purpose (In Context)</strong> (Level A): The purpose of each link can be determined from the link text alone or from the link text together with its programmatically determined link context, except where the purpose of the link would be ambiguous to users in general.</p><p><strong>4.1.2 Name, Role, Value</strong> (Level A): For all user interface components (including but not limited to: form elements, links and components generated by scripts), the name and role can be programmatically determined; states, properties, and values that can be set by the user can be programmatically set; and notification of changes to these items is available to user agents, including assistive technologies.\nNOTE: This success criterion is primarily for Web authors who develop or script their own user interface components. For example, standard HTML controls already meet this success criterion when used according to specification.</p>"""
# text = """<p>Add descriptive alternative text to logo-image, for example,&nbsp;<span class="webkit-html-attribute-name">alt</span>="<span class="webkit-html-attribute-value">Imperial Wholesale Fuel logo</span>"</p>"""
# text = """<p>&nbsp;<br></p><p><a href="https://www.w3.org/WAI/WCAG21/Techniques/aria/ARIA22" data-mce-href="https://www.w3.org/WAI/WCAG21/Techniques/aria/ARIA22">https://www.w3.org/WAI/WCAG21/Techniques/aria/ARIA22</a></p><p><u><b><i><a href="https://www.w3.org/WAI/WCAG21/Techniques/general/G199" data-mce-href="https://www.w3.org/WAI/WCAG21/Techniques/general/G199">https://www.w3.org/WAI/WCAG21/Techniques/general/G199</a></i></b></u></p>"""
# text = """<p>eee<br data-mce-bogus="1"></p><ul><li>&nbsp;ewfjje<br data-mce-bogus="1"></li><li>jgerljnrln<br data-mce-bogus="1"></li></ul><p>oooooo<br data-mce-bogus="1"></p>"""
text = """<p>The text <em>"Monitoring data is updated no later than 60 days after a two-week air sample is taken by a monitor."&nbsp;</em><em><strong>&nbsp;</strong></em>is wrapped in the &LT;span&GT; tag with styles applied to it.</p>"""
parse_html(doc, text)
doc.save('report.docx')
